<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pengurusan Kokurikulum MPU2071</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
body {
  background: linear-gradient(-45deg, #0f172a, #1e3a8a, #064e3b, #022c22);
  background-size: 400% 400%;
  animation: gradientBG 15s ease infinite;
  user-select: none;
  -webkit-user-select: none;
}
@keyframes gradientBG {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

.glass {
  background: rgba(255,255,255,0.08);
  backdrop-filter: blur(12px);
  border: 1px solid rgba(255,255,255,0.2);
}

.option {
  transition: all 0.3s ease;
}

.option:hover {
  transform: scale(1.02);
}

.selected {
  background: rgba(16,185,129,0.2) !important;
  border: 2px solid #10b981 !important;
}

.nav-number.active {
  background:#3b82f6;
  color:white;
}

.answered {
  background:#10b981 !important;
  color:white !important;
}

.progress-bar {
  height: 6px;
  background: linear-gradient(to right, #3b82f6, #10b981);
  transition: width 0.4s ease;
}
</style>
</head>

<body class="min-h-screen text-white">

<!-- HEADER -->
<div class="glass sticky top-0 z-50 p-4">

  <div class="flex justify-between items-center mb-3">
    <div>
      <p class="text-xs opacity-70">Calon</p>
      <p id="nama" class="font-bold text-lg md:text-xl">PESERTA UJIAN</p>
    </div>

    <div class="text-right">
      <p class="text-xs opacity-70">Baki Masa</p>
      <p id="timer" class="text-cyan-300 font-bold text-xl md:text-2xl">20:00</p>
    </div>
  </div>

  <div class="w-full bg-white/10 rounded-full">
    <div id="progress" class="progress-bar rounded-full" style="width:0%"></div>
  </div>

</div>

<!-- QUESTION AREA -->
<div class="max-w-4xl mx-auto mt-6 p-4">

<div class="glass p-6 rounded-2xl shadow-xl transition-all">

<div class="flex justify-between items-center mb-4">
  <div class="text-sm text-cyan-300 font-semibold">
    Soalan <span id="currentNo">1</span> / <span id="totalNo"></span>
  </div>

  <button onclick="submitQuiz()" 
  class="bg-emerald-500 hover:bg-emerald-600 px-5 py-2 rounded-xl text-sm font-semibold transition">
    Hantar Jawapan
  </button>
</div>

<hr class="opacity-20 mb-4">

<div id="questionText" class="text-base md:text-lg font-medium mb-6 leading-relaxed"></div>

<div id="options" class="space-y-3"></div>

<div class="flex justify-between mt-8">
<button onclick="prev()" 
class="bg-white/10 hover:bg-white/20 px-4 py-2 rounded-xl text-sm transition">
⬅ Sebelum
</button>

<button onclick="next()" 
class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-xl text-sm transition">
Seterusnya ➡
</button>
</div>

</div>
</div>

<!-- NAVIGATION NUMBERS -->
<div class="max-w-4xl mx-auto mt-4 p-4 glass rounded-2xl">
<div id="nav" class="flex flex-wrap gap-2 justify-center"></div>
</div>

<script>

let index = 0;
let answers = {};
let isQuizActive = false;
let timerInterval;

// ===== SOALAN =====
const questions = [
{q:"Kepentingan memahami konsep kokurikulum ialah:", opt:{A:"Jadual tetap",B:"Aktiviti mudah",C:"Selari perkembangan holistik murid",D:"Waktu petang sahaja"}, ans:"C"},
{q:"Tindakan terbaik meningkatkan penyertaan badan beruniform:", opt:{A:"Aktiviti menarik membina disiplin dan kepimpinan",B:"Wajib hadir",C:"Kurangkan aktiviti",D:"Guru pilih ketua"}, ans:"A"},
{q:"Pendekatan kolaboratif ditunjukkan melalui:", opt:{A:"Guru buat semua",B:"Murid rancang sendiri",C:"Guru dan murid rancang bersama",D:"Tugasan individu"}, ans:"C"}
];

document.getElementById("totalNo").innerText = questions.length;

// ===== RENDER FUNCTION =====
function render(){

let q = questions[index];
document.getElementById("currentNo").innerText = index+1;
document.getElementById("questionText").innerText = q.q;

let html="";

for(let k in q.opt){

let selected = answers[index]===k ? "selected" : "";

html += `
<label class="option block p-4 rounded-xl border border-white/20 bg-white/10 cursor-pointer ${selected}">
<input type="radio" name="opt" value="${k}"
${answers[index]===k ? "checked":""}
onclick="selectAnswer('${k}')"
class="mr-2">
<span class="font-semibold mr-2">${k}.</span> ${q.opt[k]}
</label>`;
}

document.getElementById("options").innerHTML = html;

renderNav();
updateProgress();
}

// ===== PILIH JAWAPAN =====
function selectAnswer(k){
answers[index] = k;
render();
}

// ===== NAVIGATION =====
function renderNav(){

let nav="";

for(let i=0;i<questions.length;i++){

let active=i===index?"active":"";
let answered=answers[i]?"answered":"";

nav += `
<button onclick="goto(${i})" 
class="nav-number ${active} ${answered} w-8 h-8 rounded-full text-sm flex items-center justify-center transition">
${i+1}
</button>`;
}

document.getElementById("nav").innerHTML = nav;
}

function next(){ 
if(index<questions.length-1){
index++; 
render();
}
}

function prev(){ 
if(index>0){
index--; 
render();
}
}

function goto(i){ 
index=i; 
render(); 
}

// ===== PROGRESS BAR =====
function updateProgress(){
let percent = (Object.keys(answers).length / questions.length) * 100;
document.getElementById("progress").style.width = percent + "%";
}

// ===== TIMER =====
function startTimer(min){

let time = min*60;

timerInterval = setInterval(()=>{

let m=Math.floor(time/60);
let s=time%60;

document.getElementById("timer").innerText = 
m+":"+(s<10?"0"+s:s);

if(time<=0){
forceSubmit("Masa Tamat");
}

time--;

},1000);
}

// ===== ANTI CHEAT =====
function enterFullscreen() {
document.documentElement.requestFullscreen().catch(()=>{});
}

function activateKillSwitch() {

document.addEventListener("visibilitychange", () => {
if (document.hidden && isQuizActive) {
isQuizActive = false;
forceSubmit("Pelanggaran: Menukar Tab / Minimize");
}
});

window.addEventListener("blur", () => {
if (isQuizActive) {
isQuizActive = false;
forceSubmit("Pelanggaran: Fokus Hilang (Blur)");
}
});

}

// ===== FORCE SUBMIT =====
function forceSubmit(reason){

clearInterval(timerInterval);

Swal.fire({
title:"UJIAN DITAMATKAN",
text: reason,
icon:"error",
confirmButtonText:"Tutup",
background:"#0f172a",
color:"#fff"
}).then(()=>{
submitQuiz();
});

}

// ===== SUBMIT NORMAL =====
function submitQuiz(){

isQuizActive = false;
clearInterval(timerInterval);

let score=0;

questions.forEach((q,i)=>{
if(answers[i]===q.ans) score++;
});

Swal.fire({
title:"KEPUTUSAN UJIAN",
html: `
<div style="font-size:20px">
Markah Anda:<br>
<b style="font-size:26px">${score} / ${questions.length}</b>
</div>
`,
icon:"success",
confirmButtonText:"Tutup",
background:"#0f172a",
color:"#fff"
});

}

// ===== START =====
function startQuiz(){

Swal.fire({
title:"AMARAN ANTI-CHEAT",
html:`
<ul style="text-align:left">
<li>Ujian akan berjalan dalam mod FULLSCREEN</li>
<li>Dilarang MINIMIZE browser</li>
<li>Dilarang tukar TAB</li>
<li>Dilarang buka aplikasi lain</li>
<li>Jika berlaku pelanggaran, ujian akan TAMAT secara automatik</li>
</ul>
`,
icon:"warning",
confirmButtonText:"Saya Faham & Setuju",
allowOutsideClick:false,
background:"#0f172a",
color:"#fff"
}).then(()=>{

enterFullscreen();
startTimer(20);

setTimeout(()=>{
isQuizActive = true;
activateKillSwitch();
},2000);

render();

});

}

startQuiz();

</script>
</body>
</html>
