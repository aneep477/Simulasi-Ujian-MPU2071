<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ujian MPU2071</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
body {
  background: linear-gradient(135deg, #004d40, #002b2b);
  min-height: 100vh;
  color:white;
}

.glass {
  background: rgba(255,255,255,0.08);
  backdrop-filter: blur(10px);
  border-radius: 15px;
}

.nav-btn {
  width:40px;
  height:40px;
  border-radius:10px;
  background:#0d5c5c;
}

.answered {
  background:#00bfa5 !important;
}

.active {
  border:2px solid white;
}
</style>

</head>

<body>

<!-- LOGIN PAGE -->
<div id="loginPage" class="flex items-center justify-center min-h-screen">

<div class="glass p-8 w-full max-w-md">

<h2 class="text-2xl font-bold mb-4">LOGIN UJIAN MPU2071</h2>

<input id="kp" placeholder="No Kad Pengenalan"
class="w-full p-3 mb-4 text-black rounded">

<button onclick="login()" 
class="w-full bg-teal-600 p-3 rounded">
Masuk
</button>

<p class="mt-4 text-sm">
Hanya 15 pelajar berdaftar dibenarkan akses
</p>

</div>
</div>

<!-- QUIZ PAGE -->
<div id="quizPage" class="hidden">

<div class="p-4 bg-teal-900 flex justify-between">

<div>
<h3 class="text-xl font-bold">UJIAN MPU2071</h3>
<p id="info"></p>
</div>

<div>
<p>Masa Tinggal</p>
<p id="timer" class="text-xl font-bold">20:00</p>
</div>

</div>

<div class="flex p-4 gap-4">

<!-- NAVIGATION -->
<div class="glass p-4 w-1/4">

<h4 class="mb-2">Navigasi Soalan</h4>

<div id="nav" class="grid grid-cols-5 gap-2"></div>

</div>

<!-- QUESTION AREA -->
<div class="glass p-6 flex-1">

<p id="no"></p>
<h3 id="question" class="mb-4"></h3>

<div id="options"></div>

<div class="mt-6 flex justify-between">
<button onclick="prev()" class="p-2 bg-teal-700 rounded">
Sebelum
</button>

<button onclick="next()" class="p-2 bg-teal-700 rounded">
Seterusnya
</button>
</div>

</div>
</div>

<div class="text-center mt-4">
<button onclick="submitQuiz()" 
class="bg-green-600 p-3 rounded">
HANTAR JAWAPAN
</button>
</div>

</div>

<script>

// ===== ADMIN ACCOUNT =====
const admin = {
kp:"admin123"
};

// ===== WHITELIST 15 PELAJAR =====
const students = [
{nama:"ABDURAHIM FAIZ BIN MAKHTARUDIN", kp:"010114-03-0523", kelas:"BNK1"},
{nama:"AHMAD HILMI BIN KAMARULARIPIN", kp:"990918-10-5427", kelas:"BNK1"},
{nama:"HUMAIRAH BINTI ABDUL RAHMAN", kp:"950913-14-7410", kelas:"BNK1"},
{nama:"MOHAMAD ZULAMIDI BIN MOHAMED RASID", kp:"981016-06-5935", kelas:"BNK1"},
{nama:"MUHAMMAD AMIRUL SYAMSURI BIN ZAHID", kp:"010915-07-0269", kelas:"BNK1"},
{nama:"MUHAMMAD KHAIRUL AMIN BIN ALIAS", kp:"971004-38-5027", kelas:"BNK1"},
{nama:"MUHAMMAD LUTFI AMIR BIN ABU BAKAR", kp:"990502-02-5597", kelas:"BNK1"},
{nama:"MUHAMMAD LUTFI BIN AB.LATIF", kp:"010409-02-0015", kelas:"BNK1"},
{nama:"MUHAMMAD NA'IM BIN AB RAZAK", kp:"941025-08-5421", kelas:"BNK1"},
{nama:"NUR FARHANAH BINTI MOHAMAD", kp:"000207-11-0080", kelas:"BNK1"},
{nama:"NUR FATIHAH BINTI ADAM", kp:"001226-08-0678", kelas:"BNK1"},
{nama:"NURUL HASANAH BINTI CHE MAD SAH", kp:"000223-06-0116", kelas:"BNK1"},
{nama:"RIZALMAN BIN ROZI", kp:"990708-03-5459", kelas:"BNK1"},
{nama:"SHAFIKAH ZAKIAH BINTI MUHAMAD", kp:"970706-01-6176", kelas:"BNK1"},
{nama:"SITI KHALIMAHTUS SAADIAH BINTI MOHD TAYIB", kp:"970706-38-5094", kelas:"BNK1"}
];

// ===== 30 SOALAN (RANGKA) =====
const questions = [
{q:"Soalan 1: .... ?", opt:{A:"",B:"",C:"",D:""}, ans:"A"},
{q:"Soalan 2: .... ?", opt:{A:"",B:"",C:"",D:""}, ans:"B"},
{q:"Soalan 3: .... ?", opt:{A:"",B:"",C:"",D:""}, ans:"C"},

// ....
// Encik boleh isi semua 30 soalan sebenar di sini

];

let index=0;
let answers={};
let time=1200;
let isQuizActive=false;

function login(){

let kp=document.getElementById("kp").value;

if(kp===admin.kp){
Swal.fire("Admin Login","Mod Admin","info");
return;
}

let s=students.find(x=>x.kp===kp);

if(!s){
Swal.fire("Akses Ditolak","Anda tidak berdaftar","error");
return;
}

localStorage.setItem("user",JSON.stringify(s));

document.getElementById("loginPage").classList.add("hidden");
document.getElementById("quizPage").classList.remove("hidden");

document.getElementById("info").innerText =
s.nama + " | " + s.kelas;

start();

}

function start(){

enterFullscreen();
activateKillSwitch();

render();

setInterval(timer,1000);

isQuizActive=true;

}

function render(){

document.getElementById("no").innerText =
"Soalan " + (index+1) + " / " + questions.length;

document.getElementById("question").innerText =
questions[index].q;

let o=questions[index].opt;

let html="";

for(let k in o){

let checked=answers[index]===k?"checked":"";

html+=`
<label class="block p-3 mb-2 bg-teal-800 rounded">
<input type="radio" name="opt" ${checked}
onclick="answers[${index}]='${k}'">
${k}. ${o[k]}
</label>`;
}

document.getElementById("options").innerHTML=html;

renderNav();

}

function renderNav(){

let html="";

for(let i=0;i<questions.length;i++){

let cls="nav-btn";

if(i===index) cls+=" active";
if(answers[i]) cls+=" answered";

html+=`
<button class="${cls}" onclick="goto(${i})">
${i+1}
</button>`;
}

document.getElementById("nav").innerHTML=html;

}

function next(){
if(index<questions.length-1){
index++;
render();
}
}

function prev(){
if(index>0){
index--;
render();
}
}

function goto(i){
index=i;
render();
}

function timer(){

time--;

let m=Math.floor(time/60);
let s=time%60;

document.getElementById("timer").innerText=
m+":"+(s<10?"0"+s:s);

if(time<=0){
forceSubmit("Masa Tamat");
}

}

function submitQuiz(){

isQuizActive=false;

let score=0;

questions.forEach((q,i)=>{
if(answers[i]===q.ans) score++;
});

Swal.fire(
"Keputusan",
"Markah anda: "+score+"/"+questions.length,
"success"
);

}

function forceSubmit(reason){

isQuizActive=false;

Swal.fire("Ujian Tamat",reason,"error")
.then(()=>submitQuiz());

}

function enterFullscreen(){
document.documentElement.requestFullscreen();
}

function activateKillSwitch(){

document.addEventListener("visibilitychange",()=>{
if(document.hidden && isQuizActive)
forceSubmit("Tukar Tab");
});

window.addEventListener("blur",()=>{
if(isQuizActive)
forceSubmit("Keluar Skrin");
});

}

</script>

</body>
</html>
